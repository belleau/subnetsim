---
title: "Validating that a specific subnetwork is significantly more connected than randomly selected subnetworks with the same number of nodes"
author:  Pascal Belleau and Astrid Deschênes
output:
  html_document:
    toc: true
bibliography: biblio.bibtex
vignette: >
  %\VignetteIndexEntry{Testing if a subnetwork is significantly more connected than randomly selected subnetworks with the same number of nodes}
  %\VignettePackage{subnetsim}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r style, echo = FALSE, results = 'asis', warning=FALSE, message=FALSE}
library(knitr)
library(subnetsim)
```

<br />

**Package**: `r packageDescription("subnetsim")[["Package"]]` <br />
**Authors**: `r packageDescription("subnetsim")[["Author"]]` <br />
**Version**: `r packageDescription("subnetsim")$Version` <br />
**Compiled date**: `r Sys.Date()` <br />
**License**: `r packageDescription("subnetsim")[["License"]]` <br />


# Licensing 

The *`r packageDescription("subnetsim")[["Package"]]`* package and the underlying 
*`r packageDescription("subnetsim")[["Package"]]`* code 
are distributed under the Artistic license 2.0. You are free to use and 
redistribute this software.


# Introduction

Network science is a cross-disciplinary domain that focuses on the representation, analysis and modeling of complex systems as networks or graphs. Networks are commonly used to study complex systems in many disciplines such as social science, computer science and  life sciences [@Bader].

A network model is a mathematical model that is designed to represent entities and their relationships in a system. A network is a collection of nodes (or vertices or sites or actors) joined by edges (or links or bonds or ties). Throught the help of modern computers, the structure of complexe and quite large networks can now be more easily generated, visualized and analyzed. Even more, as networks are logically equivalent to graphs, knownledge that can be represented as a set of entities with interactions can be represented as a network.

In computational biology, Cytoscape [@Shannon2003] is a very popular open source software platform for network modeling and visualization. Even though Cytoscape was originally designed for biological research, it is a general platform. 

The *`r packageDescription("subnetsim")[["Package"]]`* package uses random sampling to test the hypothesis that a specific 
subnetwork is more connected than randomly selected subnetworks with the same number of nodes. 
Three measures of connectivity are validated: 

* the number of nodes in the subnetwork including all the first-degree neighbor nodes
* the number of links in the subnetwork including all the links of the first-degree neighbor nodes
* the number of links in the subnetwork
    
    
# SIF Format Input

The Simple interaction file (SIF) format is one of multiple formats that Cytoscape can read.  For the moment, it is the
only format used by the *`r packageDescription("subnetsim")[["Package"]]`* package.

The SIF format only specifies nodes and interactions. This format has the advantage to be easy to 
create in a text editor or spreadsheet. The file should not have any header line.

```{r relationSIF}
# Exemple of a SIF file content

# nodeA <relationship type> nodeB
# nodeC <relationship type> nodeA
# nodeD <relationship type> nodeE nodeF nodeB
```

Duplicate entries are ignored and multiple edges between the same nodes are permitted as 
long as the relationship types are different.

Some common relationship types, used in the Systems Biology community, are: 

*  pp  : protein – protein interaction
*  pd  : protein -> DNA 

```{r SIFdemo, message=FALSE, warning=FALSE, collapse=TRUE}
# Access SIF demo file stored in the subnetsim package
networkFile <- system.file("extdata", "demo_network.sif", package="subnetsim")

# Read SIF file
sifData <- read.table(networkFile, header=FALSE)

# First line of the SIF file
head(sifData)
```


# Description of the random sampling of the subnetworks

The simulated subnetworks are generated by random sampling from a global network. 
The global network must correspond to the network that the tested subnetwork comes from.
Each simulated sunbetwork contains the exact same number of nodes than the real subnetwork. 
The *`r packageDescription("subnetsim")[["Package"]]`* package validates that there is no
two identical simulated subnetworks among all simulated subnetworks.


# An analysis step by step


## Loading subnetsim package

As with any R package, the *`r packageDescription("subnetsim")[["Package"]]`* package should 
first be loaded with the following command:

```{r loadingPackage, warning=FALSE, message=FALSE}
library(subnetsim)
```


## Loading the global network and the tested subnetwork

The networks must be in a SIF format file. The *network()* function 
must be used to load the networks.

```{r loadNetwork, warning=FALSE, message=FALSE, collapse=TRUE, cache=TRUE}
# Access demo files stored in the subnetsim package
networkFile <- system.file("extdata", "demo_network.sif", package="subnetsim")
subnetworkFile <- system.file("extdata", "demo_subnetwork.sif", package="subnetsim")

# Load a global network and its tested subnetwork using 
# SIF format files
demo_network_with_sub <- network(netFileName = networkFile,
                                 subNetFileName = subnetworkFile)

# The returned object is an object of class "network"
class(demo_network_with_sub)

# The network object contains the information from the global network
# 1- All the links between each nodes in a hash format
summary(demo_network_with_sub$netAll)
# 2- All the names of the nodes
head(demo_network_with_sub$nodesAll)
```


## Generating the simulated subnetwork

A fixed number of simulated subnetworks are generated through the *simuleSubNet()* function.
Random sampling is used to generate subnetworks that have the exact same number of nodes than
the tested subnetwork. The function validates that the same simulated subnetwork is not 
generated twice.

```{r simSubNet, warning=FALSE, message=FALSE, collapse=TRUE, cache=TRUE}
simulatedSubnetwork <- subnetwork(network = demo_network_with_sub, nbIter = 30, seedV = 111111)

# The returned object is an object of class "subnetwork"
class(simulatedSubnetwork)

# The content of the "subnetwork" is easily accessible
simulatedSubnetwork
```

## Extract information from the simulated subnetwork

TODO


## Plot the results

A graph showing the position of the observed values comparing to the simulated results can be easily 
generated using the *plot()* function.

```{r graphRes, warning=FALSE, message=FALSE, collapse=TRUE, cache=TRUE, fig.align="center"}
# Generate a graph for the three measures of connectivity
plot(simulatedSubnetwork)
```


# Session info

Here is the output of sessionInfo() on the system on which this document 
was compiled:

```{r sessionInfo, echo=FALSE}
sessionInfo()
```


# References

